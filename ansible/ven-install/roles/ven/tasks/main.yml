# Copy, install, and activate VEN on all Windows boxes
- hosts: win
  tasks:
    - name: Windows - copy the VEN MSI to the remote hosts
      win_copy:
        src: ../ven/VENInstaller-19.3.0-6104-x64.msi
        dest: C:\Users\Administrator\windows-ven.msi
    - name: Windows - install the VEN MSI
      win_package:
        path: C:\Users\Administrator\windows-ven.msi
    - name: Windows - activate the VEN
      win_shell: .\illumio-ven-ctl.ps1 activate -management-server p-lab.poc.segmentationpov.com:8443 -activation-code "{{ pairing_key }}"
      args:
        chdir: C:\Program Files\Illumio

# Copy, install, and activate VEN on all CentOS boxes
- hosts: linux
  tasks:
    - name: Linux - copy the VEN RPM to the remote hosts
      copy:
        src: ../ven/illumio-ven-19.3.0-6104.c{{ ansible_distribution_major_version }}.x86_64.rpm
        dest: /tmp/ven.rpm
    - name: Linux - install the VEN RPM
      become: true
      become_user: root
      yum:
        name: /tmp/ven.rpm
    - name: Linux - activate the VEN
      become: true
      become_user: root
      shell:
        cmd: /opt/illumio_ven/illumio-ven-ctl activate --management-server p-lab.poc.segmentationpov.com:8443 --activation-code "{{ pairing_key }}"
